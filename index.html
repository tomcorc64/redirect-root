<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Integravision Studio</title>
    <link rel="icon" type="image/png" sizes="32x32" href="https://raw.githubusercontent.com/tomcorc64/integravision-web/main/favicon1.png" />
    <link rel="icon" type="image/png" sizes="192x192" href="https://raw.githubusercontent.com/tomcorc64/integravision-web/main/favicon1.png" />
    <link rel="apple-touch-icon" href="https://raw.githubusercontent.com/tomcorc64/integravision-web/main/favicon1.png" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <style>

        /* --- ESTILOS PARA EL BOTÓN DE TEMA OSCURO --- */

        /* Posicionamiento del botón */
        .header-content {
            position: relative; /* Necesario para posicionar el botón dentro */
        }

        #theme-toggle {
            position: absolute;
            top: 50%;
            right: 30px; /* Distancia desde la derecha */
            transform: translateY(-50%); /* Centrado vertical perfecto */
            background: none;
            border: none;
            color: var(--white-color);
            font-size: 1.8rem; /* Tamaño del ícono */
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        #theme-toggle:hover {
            transform: translateY(-50%) scale(1.15); /* Efecto al pasar el mouse */
        }


        /* --- DEFINICIÓN DEL TEMA OSCURO --- */

        /* Cuando el body tenga la clase "dark-mode", estos colores se aplicarán */
        body.dark-mode {
            --primary-color: #e5e7eb;         /* Color de texto principal (gris claro) */
            --secondary-color: #14b8a6;       /* Se mantiene el verde azulado para acentos */
            --light-bg-color: #0f172a;        /* Fondo principal de la página (azul muy oscuro) */
            --white-color: #1f2937;           /* Fondo de las tarjetas y secciones (azul oscuro) */
            --gray-border: #4b5563;           /* Color de los bordes */
            --dark-gray: #9ca3af;             /* Color de texto secundario */
        }

        body.dark-mode #page-gallery,
        body.dark-mode #page-thanks {
            background-color: rgba(31,41,55,0.92); /* Fuerte fondo oscuro y semitransparente */
        }

        /* Opcional: para asegurar contraste adecuado en los textos de títulos */
        body.dark-mode .gallery-title,
        body.dark-mode .thank-you-section h2 {
            color: var(--primary-color); /* O un color específico claro, ejemplo: #e5e7eb */
        }

        /* Casos especiales que no se cambian automáticamente con las variables */
        body.dark-mode header {
            background-color: #1f2937; /* El header debe ser oscuro */
            color: #e5e7eb;
        }

        body.dark-mode .logo-redondo {
            border-color: #4b5563; /* Borde del logo */
            background-color: #374151;
        }

        body.dark-mode .thank-you-section p {
            color: #d1d5db; /* Texto de párrafos en oscuro */
        }

        /* Cambia el color del ícono del tema cuando está en modo oscuro */
        body.dark-mode #theme-toggle {
            color: #facc15; /* Color sol (amarillo) */
        }

        :root {
            --primary-color: #1e3a8a; /* Azul oscuro */
            --secondary-color: #14b8a6; /* Verde azulado */
            --light-bg-color: #f9fafb;
            --white-color: #ffffff;
            --gray-border: #b0b0b0;
            --light-gray: #e0e0e0;
            --dark-gray: #666;
            --box-shadow-light: 0 2px 6px rgba(0,0,0,0.1);
            --box-shadow-medium: 0 2px 8px rgba(0, 0, 0, 0.05);
            --box-shadow-strong: 0 2px 12px rgba(0, 0, 0, 0.08);
        }

        /* HTML y Body para Scroll Snapping */
        html, body {
            margin: 0;
            font-family: 'Segoe UI', sans-serif;
            background-color: var(--light-bg-color);
            color: var(--primary-color);
            height: 100%; /* Permite que el body ocupe el 100% de la ventana */
            overflow: hidden; /* Oculta el scroll inicial antes del loader */
            scroll-behavior: smooth;
        }

        body {
            scroll-snap-type: y mandatory; /* Habilita el scroll snapping vertical en el body */
            overflow-y: scroll; /* Permite el scroll vertical en el body */
        }

        /* Pantalla de carga */
        #loader-bg {
            position: fixed;
            z-index: 99999;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            width: 100vw;
            height: 100vh;
            background: var(--light-bg-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: opacity 0.5s;
            overflow: hidden;
        }
        #loader-floating {
            position: absolute;
            width: 100vw;
            height: 100vh;
            top: 0;
            left: 0;
            pointer-events: none;
            z-index: 1;
        }
        .floating-img,
        .floating-section-loader {
            position: absolute;
            opacity: 0.28;
            border-radius: 18px;
            user-select: none;
            pointer-events: none;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
            will-change: transform;
            animation: floatBounce 3s linear infinite;
        }
        .floating-img {
            width: 120px;
            height: 80px;
            object-fit: cover;
        }
        .floating-section-loader {
            background: var(--white-color);
            padding: 24px 32px;
            font-size: 1.1rem;
            min-width: 200px;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1.5px solid var(--gray-border);
        }
        @keyframes floatBounce {
            0% {
                filter: blur(0px);
            }
            50% {
                filter: blur(2px);
            }
            100% {
                filter: blur(0px);
            }
        }
        #loader-logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 2rem;
            z-index: 2;
        }
        #loader-logo {
            width: 270px;
            height: 270px;
            border-radius: 50%;
            border: 12px solid var(--gray-border);
            object-fit: cover;
            box-sizing: border-box;
            animation: pulse 1.2s infinite;
            background: var(--white-color);
            z-index: 2;
        }
        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(20, 184, 166, 0.4);
            }
            70% {
                box-shadow: 0 0 0 37.5px rgba(20, 184, 166, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(20, 184, 166, 0);
            }
        }
        #loader-bar-bg {
            width: 320px;
            height: 14px;
            background: var(--light-gray);
            border-radius: 7px;
            overflow: hidden;
            margin: 0 auto;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
            z-index: 2;
        }
        #loader-bar {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, var(--secondary-color) 60%, var(--primary-color) 100%);
            border-radius: 7px 0 0 7px;
            transition: width 0.2s;
        }

        /* Header fijo */
        header {
            background-color: var(--primary-color);
            color: white;
            padding-top: 0rem;
            padding-bottom: 1rem; /* Ajuste el padding para los botones */
            text-align: center;
            position: fixed; /* Fijo en la parte superior */
            top: 0;
            left: 0;
            width: 100%;
            z-index: 1000; /* Asegura que esté por encima de todo el contenido y el fondo */
            border-radius: 0 0 12px 12px;
            box-shadow: var(--box-shadow-light);
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .header-content {
            text-align: center;
            padding-top: 1rem;
            position: relative;
            z-index: 1;
            width: 100%;
            padding-bottom: 0.5rem; /* Espacio antes de los botones */
        }
        header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            margin-top: 0; /* Eliminar margen superior predeterminado */
        }
        header p {
            font-size: 1.2rem;
            margin-bottom: 0.5rem; /* Menos margen para acercar los botones */
        }

        /* Logo aumentado un 30% con borde plomo y efecto hover */
        .logo-redondo {
            width: 292.5px; /* 225 * 1.3 */
            height: 292.5px;
            border-radius: 50%;
            object-fit: cover;
            position: absolute;
            bottom: -146.25px; /* Mitad del tamaño para que quede justo al centro del borde inferior */
            left: 50px; /* Alineado a la izquierda */
            border: 5px solid var(--gray-border);
            transition: transform 0.3s ease;
            box-sizing: border-box;
            background-color: var(--white-color);
            z-index: 1010; /* Encima del header */
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.2));
        }
        .logo-redondo:hover {
            transform: scale(1.05);
            cursor: pointer;
        }

        /* Botones de navegación */
        .nav-buttons-container {
            display: flex;
            justify-content: center;
            gap: 1rem;
            width: 100%;
            padding: 0.5rem 0; /* Un poco de padding para los botones */
            box-sizing: border-box;
        }
        .hero-button {
            background-color: var(--secondary-color);
            color: var(--white-color);
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 5px;
            font-size: 1rem;
            cursor: pointer;
            text-decoration: none;
            transition: background-color 0.3s ease;
            white-space: nowrap; /* Evita que los botones se rompan en varias líneas */
        }
        .hero-button:hover {
            background-color: #108e7e;
        }

        /* Estilos para cada "página" (sección) */
        .page-section {
            min-height: 100vh; /* Cada sección ocupa al menos el 100% de la altura de la ventana */
            display: flex;
            flex-direction: column;
            justify-content: center; /* Centra el contenido verticalmente */
            align-items: center;
            padding: 2rem;
            box-sizing: border-box;
            scroll-snap-align: start; /* Alinea el inicio de la sección con el borde del contenedor de scroll */
            position: relative;
            z-index: 2; /* Asegura que el contenido de la página esté sobre el fondo flotante */
            background-color: rgba(255,255,255,0.85); /* Fondo semi-transparente para la página para que el contenido sea legible */
            padding-top: 350px; /* Espacio para el header fijo y el logo, ajustado */
            overflow-y: auto; /* Permite el scroll dentro de la sección si el contenido es demasiado grande */
        }

        /* Galería */
        .gallery-title {
            text-align:center;
            color:var(--primary-color);
            font-size:2.5rem;
            margin-top:2rem;
            margin-bottom: 2rem;
            z-index: 3; /* Para que el título esté sobre el fondo semi-transparente de la sección */
        }
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); /* Imágenes un poco más grandes */
            gap: 15px; /* Más espacio entre imágenes */
            padding: 1.5rem;
            max-width: 950px; /* Para que la galería no ocupe todo el ancho si main-container es más grande */
            width: 100%;
            box-sizing: border-box;
            background-color: rgba(255,255,255,0.8); /* Fondo semi-transparente para la galería */
            border-radius: 12px;
            padding-bottom: 3rem;
            box-shadow: var(--box-shadow-medium);
            z-index: 3;
        }
        .gallery-grid img {
            width: 100%;
            height: 180px; /* Altura fija para uniformidad */
            object-fit: cover;
            border-radius: 8px;
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0,0,0,0.15); /* Sombra más pronunciada */
        }
        .gallery-grid img:hover {
            transform: scale(1.03); /* Menor aumento para no ser tan brusco */
            box-shadow: 0 6px 12px rgba(0,0,0,0.25);
        }

        /* Lightbox (ampliador de imágenes) */
        .lightbox {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            justify-content: center;
            align-items: center;
            flex-direction: column;
            z-index: 10000;
        }
        .lightbox img {
            max-width: 90%;
            max-height: 90vh;
            border-radius: 8px;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
        }
        .lightbox .controls {
            display: flex;
            justify-content: center;
            gap: 2rem;
            color: white;
            font-size: 2rem;
            margin-top: 1rem;
        }
        .lightbox .controls i {
            cursor: pointer;
            text-shadow: 0 0 10px rgba(0,0,0,0.5);
        }

        /* Contenedor para contacto y noticias lado a lado */
        #contact-news-container {
            display: flex;
            gap: 2rem;
            padding: 2.5rem; /* Mayor padding */
            background-color: var(--white-color);
            border-top: 3px solid var(--secondary-color);
            border-radius: 8px;
            box-shadow: var(--box-shadow-strong); /* Sombra más fuerte */
            justify-content: center;
            flex-wrap: wrap;
            width: 100%;
            max-width: 900px; /* Más ancho */
            box-sizing: border-box;
            margin-top: 2rem;
        }
        #contact-news-container > div {
            flex: 1 1 48%; /* Ajuste para un poco más de espacio */
            min-width: 320px;
            box-sizing: border-box;
        }
        #contact-news-container h2, #contact-news-container h3 {
            color: var(--primary-color);
            text-align: center;
            margin-bottom: 1.5rem;
        }

        /* Estilos del Formulario de Contacto */
        .contact-form {
            box-sizing: border-box;
            padding: 1.5rem;
            background-color: var(--white-color);
            border-radius: 8px;
            box-shadow: var(--box-shadow-light);
            border: 1px solid var(--light-gray);
        }
        .contact-form label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--primary-color);
            font-weight: bold;
        }
        .contact-form input[type="text"],
        .contact-form input[type="email"],
        .contact-form textarea {
            width: 100%;
            padding: 0.75rem;
            margin-bottom: 1rem;
            border: 1px solid var(--gray-border);
            border-radius: 4px;
            font-size: 1rem;
            box-sizing: border-box;
            transition: border-color 0.3s ease;
        }
        .contact-form input[type="text"]:focus,
        .contact-form input[type="email"]:focus,
        .contact-form textarea:focus {
            border-color: var(--secondary-color);
            outline: none;
        }
        .contact-form button[type="submit"] {
            background-color: var(--secondary-color);
            color: var(--white-color);
            border: none;
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
        }
        .contact-form button[type="submit"]:hover {
            background-color: #108e7e;
            transform: translateY(-2px);
        }

        /* Estilos de la sección de noticias */
        #rave-news {
            padding: 1.5rem;
            background: var(--white-color);
            border-radius: 8px;
            box-shadow: var(--box-shadow-light);
            border: 1px solid var(--light-gray);
        }
        #rave-news ul {
            list-style:none;
            padding:0;
            font-size: 0.95rem;
            line-height: 1.8;
            text-align: left;
        }
        #rave-news li a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: bold;
            transition: color 0.3s ease;
        }
        #rave-news li a:hover {
            color: var(--secondary-color);
            text-decoration: underline;
        }
        #rave-news li small {
            color:var(--dark-gray);
            display: block;
            margin-top: 0.2rem;
            font-size: 0.8rem;
        }

        /* Sección de Agradecimiento */
        .thank-you-section {
            text-align: center;
            background-color: rgba(240, 240, 240, 0.9); /* Gris muy suave y semi-transparente */
            border-top: 3px solid var(--secondary-color);
            border-radius: 8px;
            box-shadow: var(--box-shadow-strong);
            width: 100%;
            max-width: 900px; /* Aumenta el ancho */
            box-sizing: border-box;
            margin-top: 2rem;
        }
        .thank-you-section h2 {
            color: var(--secondary-color);
            margin-bottom: 1.8rem;
            font-size: 2.5rem;
        }
        .thank-you-section p {
            margin-bottom: 1.8rem;
            line-height: 1.8;
            font-size: 1.15rem;
            color: #333;
            text-align: center;
            text-justify: inter-word;
        }
        .thank-you-section img.graphic { /* Estilo para el nuevo gráfico */
            max-width: 250px;
            height: auto;
            margin-bottom: 2.5rem;
            opacity: 0.9; /* Pequeña transparencia para integrarse con el fondo */
            border-radius: 8px;
            box-shadow: var(--box-shadow-medium);
        }
        .thank-you-section button {
            background-color: var(--secondary-color);
            color: var(--white-color);
            border: none;
            padding: 0.9rem 2rem;
            font-size: 1.1rem;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
        }
        .thank-you-section button:hover {
            background-color: #108e7e;
            transform: translateY(-2px);
        }

        /* Fondo dinámico de imágenes */
        #background-floating-images {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            pointer-events: none; /* Permite clicks a través de él */
            overflow: hidden;
            z-index: 0; /* Asegura que esté en el fondo absoluto */
        }
        .bg-floating-img {
            position: absolute;
            opacity: 0.05; /* Muy transparente */
            border-radius: 8px;
            user-select: none;
            object-fit: cover;
            will-change: transform, opacity;
            animation: bgFloatFade 15s infinite ease-in-out alternate;
        }
        @keyframes bgFloatFade {
            0% { transform: translate(0, 0) scale(1); opacity: 0.05; }
            25% { transform: translate(random(-20, 20)px, random(-20, 20)px) scale(random(1, 1.02)); opacity: 0.07; }
            50% { transform: translate(random(-20, 20)px, random(-20, 20)px) scale(random(1, 1.04)); opacity: 0.09; }
            75% { transform: translate(random(-20, 20)px, random(-20, 20)px) scale(random(1, 1.02)); opacity: 0.07; }
            100% { transform: translate(0, 0) scale(1); opacity: 0.05; }
        }


        /* Media Queries para Responsividad */
        @media (max-width: 768px) {
            header {
                padding-bottom: 0.5rem;
                border-radius: 0; /* Sin bordes redondeados en móviles */
                position: static; /* No fijo en móviles, se desplaza con el contenido */
                height: auto;
            }
            .header-content h1 {
                font-size: 1.8rem;
            }
            .header-content p {
                font-size: 0.9rem;
            }
            .logo-redondo {
                position: static; /* Se comporta como un elemento normal */
                width: 150px;
                height: 150px;
                margin: 0.5rem auto 1rem auto; /* Centrar y margen inferior */
                display: block;
                transform: none; /* Eliminar cualquier transformación */
                left: auto;
                bottom: auto;
                filter: none; /* Sin sombra en móviles */
            }
            .nav-buttons-container {
                flex-direction: column; /* Botones apilados */
                gap: 0.5rem;
                padding: 0 1rem;
            }
            .hero-button {
                width: 100%;
                box-sizing: border-box;
            }
            .page-section {
                padding-top: 1rem; /* Menor padding para el header fijo en móviles, que ahora es estático */
                min-height: auto; /* Permite que las secciones se adapten a su contenido */
                scroll-snap-align: none; /* Deshabilita scroll snapping en móviles */
                overflow-y: visible; /* Permite scroll normal dentro de la sección */
                background-color: var(--light-bg-color); /* Fondo completo para mejor legibilidad */
            }
            body {
                scroll-snap-type: none; /* Deshabilita scroll snapping en el body en móviles */
                overflow-y: scroll; /* Scroll normal */
            }

            .gallery-grid {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
                gap: 8px;
                padding: 0.8rem;
                max-width: 100%;
            }
            .gallery-grid img {
                height: 120px;
            }
            #contact-news-container {
                flex-direction: column;
                gap: 1.5rem;
                padding: 1.5rem;
                max-width: 100%;
            }
            #contact-news-container > div {
                min-width: unset;
            }
            .thank-you-section {
                padding: 2rem 1rem;
                max-width: 100%;
            }
            .thank-you-section h2 {
                font-size: 1.8rem;
            }
            .thank-you-section p {
                font-size: 1rem;
            }
            .thank-you-section img.graphic {
                display: none;
            }
        }

        /* --- ESTILOS PARA LA NUEVA GALERÍA CON FILTROS --- */
        #gallery-filters {
            margin-bottom: 2rem;
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .filter-button {
            background-color: var(--white-color);
            color: var(--primary-color);
            border: 2px solid var(--secondary-color);
            padding: 0.5rem 1.5rem;
            border-radius: 20px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .filter-button:hover {
            background-color: var(--secondary-color);
            color: #fff;
        }

        .filter-button.active {
            background-color: var(--secondary-color);
            color: #fff;
            box-shadow: 0 4px 12px rgba(20, 184, 166, 0.4);
        }
        
        body.dark-mode .filter-button {
             background-color: #374151;
             border-color: var(--secondary-color);
             color: var(--primary-color);
        }

        body.dark-mode .filter-button:hover,
        body.dark-mode .filter-button.active {
            background-color: var(--secondary-color);
            color: #fff;
        }

        .gallery {
            width: 100%;
            max-width: 950px;
        }
        
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 15px;
            width: 100%;
        }

        .gallery-item {
            position: relative;
            cursor: pointer;
            overflow: hidden;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .gallery-item:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 12px rgba(0,0,0,0.25);
        }

        .gallery-item img, .gallery-item video {
            width: 100%;
            height: 180px;
            object-fit: cover;
            display: block;
        }
        
        .video-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.3);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 3rem;
            color: rgba(255,255,255,0.8);
            pointer-events: none; /* Allows clicks to go through to the item */
        }
        
        /* Estilos para el nuevo lightbox de video */
        #video-lightbox video {
            max-width: 90%;
            max-height: 90vh;
            border-radius: 8px;
            background: black;
        }
    </style>
</head>
<body>
    <div id="loader-bg">
        <div id="loader-floating"></div>
        <div id="loader-logo-container">
            <video id="loader-logo" src="https://raw.githubusercontent.com/tomcorc64/integravision-web/main/ivslogovid300725.mp4" autoplay muted loop playsinline></video>
        </div>
        <div id="loader-bar-bg">
            <div id="loader-bar"></div>
        </div>
    </div>

    <div id="background-floating-images"></div>

    <header>
        <div class="header-content">
            <h1>IntegraVision Studio</h1>
            <button id="theme-toggle" title="Cambiar tema">
            <i class="fas fa-moon"></i>
            </button>
            <p>Transformando la educación a través de soluciones audiovisuales integradas.</p>
        </div>
        <video
            id="main-logo-video"
            src="https://raw.githubusercontent.com/tomcorc64/integravision-web/main/ivslogovid300725.mp4"
            alt="Logo Integravision"
            class="logo-redondo"
            muted
            playsinline
            title="Haz click para animar el logo"
        ></video>
        <div class="nav-buttons-container">
            <a class="hero-button" href="#page-gallery">Nuestra Galería</a>
            <a class="hero-button" href="#page-contact-news">Contáctanos y Noticias</a>
            <a class="hero-button" href="#page-thanks">Agradecimiento</a>
        </div>
    </header>

    <section id="page-gallery" class="page-section">
        <h2 class="gallery-title">Galería de Proyectos</h2>

        <div id="gallery-filters">
            <button class="filter-button active" data-filter="all">Todas</button>
            <button class="filter-button" data-filter="implementaciones">Implementaciones</button>
            <button class="filter-button" data-filter="modelados">Modelados</button>
            <button class="filter-button" data-filter="accesorios">Accesorios</button>
        </div>

        <div id="gallery-container">
            </div>

        <div class="lightbox" id="image-lightbox">
            <img id="lightbox-img" src="" alt="Imagen ampliada" />
            <div class="controls">
                <i class="fas fa-arrow-left" onclick="navigateLightbox(-1)" aria-label="Imagen anterior"></i>
                <i class="fas fa-times" onclick="closeImageLightbox()" aria-label="Cerrar"></i>
                <i class="fas fa-arrow-right" onclick="navigateLightbox(1)" aria-label="Imagen siguiente"></i>
            </div>
        </div>

        <div class="lightbox" id="video-lightbox">
            <video id="lightbox-video" src="" controls muted></video>
            <div class="controls">
                <i class="fas fa-times" onclick="closeVideoLightbox()" aria-label="Cerrar"></i>
            </div>
        </div>
    </section>

    <section id="page-contact-news" class="page-section">
        <div id="contact-news-container">
            <div id="contacto">
                <h2>Contáctanos</h2>
                <form action="https://formspree.io/f/mvgrwyzz" method="POST" class="contact-form">
                    <label for="name"><i class="fas fa-user"></i> Nombre</label>
                    <input type="text" id="name" name="name" required />
                    <label for="email"><i class="fas fa-envelope"></i> Correo electrónico</label>
                    <input type="email" id="email" name="email" required />
                    <label for="message"><i class="fas fa-comment-dots"></i> Mensaje</label>
                    <textarea id="message" name="message" rows="5" required></textarea>
                    <button type="submit">Enviar</button>
                    <input type="hidden" name="_redirect" value="https://integravisionstudio.dedyn.io/#page-thanks" />
                </form>
            </div>
            <div id="rave-news">
                <h3>
                    <img src="https://www.ravepubs.com/wp-content/themes/md-changes/img/rave-logo.png" alt="RavePubs" style="height: 24px; vertical-align: middle" />
                    Noticias rAVe&thinsp;[PUBS]
                </h3>
                <ul id="rave-feed"></ul>
            </div>
        </div>
    </section>

    <section id="page-thanks" class="page-section thank-you-section">
        <h2>✅ ¡Gracias por contactarnos!</h2>
        <p>
            Apreciamos sinceramente tu interés en IntegraVision Studio. Tu mensaje ha sido recibido con éxito y nuestro equipo está revisándolo cuidadosamente.
            Nos esforzamos por ofrecer soluciones audiovisuales integradas de la más alta calidad para transformar la educación y otros espacios, impulsando la innovación y la eficiencia en cada proyecto. Nuestra misión es crear ambientes de aprendizaje dinámicos y colaborativos mediante tecnologías de vanguardia.
        </p>
        <p>
            En breve, uno de nuestros especialistas se pondrá en contacto contigo para entender mejor tus necesidades y explorar cómo podemos ayudarte a alcanzar tus objetivos. Nos comprometemos a proporcionarte una atención personalizada, un asesoramiento experto y soluciones a medida que no solo satisfagan, sino que superen tus expectativas. La integración audiovisual es nuestra pasión y la educación, nuestra vocación.
        </p>
        <p>
            Mientras tanto, te invitamos a explorar más sobre nuestros proyectos recientes en la galería para que conozcas la diversidad y calidad de nuestras implementaciones en diversas instituciones educativas y corporativas. También puedes revisar las últimas noticias del sector en rAVe [PUBS] para mantenerte al día con las tendencias e innovaciones en tecnología audiovisual que aplicamos en nuestros servicios.
        </p>
        <p>
            ¡Gracias por tu paciencia y por elegir a IntegraVision Studio como tu aliado estratégico en el camino hacia la excelencia audiovisual y educativa! Esperamos construir una relación duradera y exitosa contigo, contribuyendo al avance tecnológico de tu institución.
        </p>
        <button onclick="window.location.href = '#page-gallery'">
            Volver a la Galería
        </button>
    </section>

    <script>
        // --- INICIO DE LA NUEVA LÓGICA DE LA PÁGINA ---

        // URL base para todas las imágenes y videos en GitHub
        const GITHUB_BASE_URL = 'https://raw.githubusercontent.com/tomcorc64/integravision-web/main/';

        // Objeto con todas las galerías y su contenido
        const galleries = {
            implementaciones: {
                title: 'Implementaciones de Soluciones de Integracion AV',
                items: [
                    { src: '079c43c3-f39b-48ed-ad41-19ab100e2286.jpg', type: 'image' },
                    { src: '2012-01-24%2010.25.22.jpg', type: 'image' },
                    { src: '2012-01-24%2010.33.29.jpg', type: 'image' },
                    { src: '20121108_094130.jpg', type: 'image' },
                    { src: '2012-12-10%2011.46.24.jpg', type: 'image' },
                    { src: '2013-01-24%2008.02.09(1).jpg', type: 'image' },
                    { src: '2014-02-24_19-54-40_226%20(2).jpg', type: 'image' },
                    { src: '2014-02-24_19-55-11_42(1).jpg', type: 'image' },
                    { src: '2014-09-30_02_47_14.gif', type: 'image' },
                    { src: '20160408_121513.jpg', type: 'image' },
                    { src: '20160829_122833_HDR.jpg', type: 'image' },
                    { src: '20160829_163701_HDR.jpg', type: 'image' },
                    { src: '20190307_082923_HDR.jpg', type: 'image' },
                    { src: '20190307_082928_HDR.jpg', type: 'image' },
                    { src: '20190307_113620_HDR.jpg', type: 'image' },
                    { src: '65d8b410-7dc7-49f3-a544-39fdbacb13b0.jpg', type: 'image' },
                    { src: '6D5DFE3FEA648B4F1C6E88709F1277A3_7C0.jpeg', type: 'image' },
                    { src: '85e33b45-d3a0-4394-94db-108eddeaacab.jpg', type: 'image' },
                    { src: '921a4898-7922-4e38-8f7b-f6c1929b994d.jpg', type: 'image' },
                    { src: 'AOC-LIMA-PRESENTACI%C3%93N11ABRIL-2-590243.jpg', type: 'image' },
                    { src: 'DMC-FZ70374.JPG', type: 'image' },
                    { src: 'DMC-FZ70477.JPG', type: 'image' },
                    { src: 'e0ce0942-c800-43cb-bc14-1a32b31f4936.jpg', type: 'image' },
                    { src: 'IMAG0008.jpg', type: 'image' },
                    { src: 'IMAG0043.jpg', type: 'image' },
                    { src: 'IMG-20130125-WA0000.jpg', type: 'image' },
                    { src: 'IMG_20131219_130127956.jpg', type: 'image' },
                    { src: 'IMG_20150126_143827982_HDR.jpg', type: 'image' },
                    { src: 'IMG_20150407_173026.jpg', type: 'image' },
                    { src: 'IMG-20180905-WA0001.jpg', type: 'image' },
                    { src: 'IMG_20190405_195843769.jpg', type: 'image' },
                    { src: 'IMG_20190614_111832749%20(2).jpg', type: 'image' },
                    { src: 'IMG_20190614_111914142.jpg', type: 'image' },
                    { src: 'IMG_20190614_185320494.jpg', type: 'image' },
                    { src: 'IMG_20190614_185430514.jpg', type: 'image' },
                    { src: 'IMG_20190724_173321466.jpg', type: 'image' },
                    { src: 'IMG_20190724_173401771.jpg', type: 'image' },
                    { src: 'IMG_20191213_141159202-PANO.jpg', type: 'image' },
                    { src: 'IMG-20200325-WA0009.jpg', type: 'image' },
                    { src: 'IMG20201109123530.jpg', type: 'image' },
                    { src: 'IMG20210301085938.jpg', type: 'image' },
                    { src: 'IMG20220608133046.jpg', type: 'image' },
                    { src: 'IMG20221028101801.jpg', type: 'image' },
                    { src: 'IMG20230130103603.jpg', type: 'image' },
                    { src: 'IMG20230717103507.jpg', type: 'image' },
                    { src: 'IMG20230718152337.jpg', type: 'image' },
                    { src: 'IMG20231018143127.jpg', type: 'image' },
                    { src: 'IMG20240507101909.jpg', type: 'image' },
                    { src: 'IMG_20240830_123414608_AE.jpg', type: 'image' },
                    { src: 'IMG_20241217_122721330_AE.jpg', type: 'image' },
                    { src: 'IMG-20241219-WA0050.jpg', type: 'image' },
                    { src: 'P1030043.JPG', type: 'image' },
                    { src: 'P1030047.JPG', type: 'image' },
                    { src: 'WhatsApp%20Image%202021-01-20%20at%2009.39.49.jpeg', type: 'image' },
                    { src: 'WhatsApp%20Image%202021-10-18%20at%2011.19.55%20(3).jpeg', type: 'image' },
                    { src: 'WhatsApp%20Image%202021-10-18%20at%2011.19.55.jpeg', type: 'image' }
                ]
            },
            modelados: {
                title: 'Modelados de Integracion AV',
                items: [
                    { src: '4.png', type: 'image' },
                    { src: 'actual%202%20(2).JPG', type: 'image' },
                    { src: 'Auditorio%20AC%202.png', type: 'image' },
                    { src: 'AUDITORIO%20AC%20RETORNOS(2).png', type: 'image' },
                    { src: 'Directorio.png', type: 'image' },
                    { src: 'direectorio%20ccl%201.png', type: 'image' },
                    { src: 'direectorio%20ccl%203.png', type: 'image' },
                    { src: 'Dise%C3%B1o%20de%20aula%20(1)(1).png', type: 'image' },
                    { src: 'Dise%C3%B1o%20de%20aula.png', type: 'image' },
                    { src: 'dise%C3%B1o%20de%20rack%20tv%20310717.png', type: 'image' },
                    { src: 'luz%20del%20sur%20modelado%20opciones%20(3).png', type: 'image' },
                    { src: 'luz%20del%20sur%20modelado%20opciones%20(5).png', type: 'image' },
                    { src: 'MINJUS%20CALLAO%20CAMARA%20GESELL%20(1).png', type: 'image' },
                    { src: 'MINJUS%20CALLAO%20CAMARA%20GESELL%20(2).png', type: 'image' },
                    { src: 'MINJUS%20CALLAO%20CAMARA%20GESELL.png', type: 'image' },
                    { src: 'mod%202%20sala%20de%20reuniones%20adidas%20030111.jpg', type: 'image' },
                    { src: 'mod%206%20sala%20de%20reuniones%20adidas%20030111.jpg', type: 'image' },
                    { src: 'opc2-c.JPG', type: 'image' },
                    { src: 'opcion%202%20-%20aula%20hibrida%20(3).png', type: 'image' },
                    { src: 'OPERADORES%20101120%20(2).png', type: 'image' },
                    { src: 'OPERADORES%20101120.png', type: 'image' },
                    { src: 'SALA%20OVAL%20180321-1.png', type: 'image' },
                    { src: 'Screenshot_20230106_041356.png', type: 'image' },
                    { src: 'vista%205.png', type: 'image' },
                    { src: 'vista%206.png', type: 'image' }
                ]
            },
            accesorios: {
                title: 'Accesorios de Integracion AV',
                items: [
                    { src: '08-parltante%20-%202%20unidades.jpg', type: 'image' },
                    { src: '09b7a199-313b-4848-b34f-dc4fa88e9c16.jpg', type: 'image' },
                    { src: '2012-01-24%2010.42.13.jpg', type: 'image' },
                    { src: '2012-01-24%2010.44.44.jpg', type: 'image' },
                    { src: '2012-02-03%2012.47.38.jpg', type: 'image' },
                    { src: '2012-10-24%2011.56.07.jpg', type: 'image' },
                    { src: '2012-12-10%2012.56.50.jpg', type: 'image' },
                    { src: '20160829_163656_HDR.jpg', type: 'image' },
                    { src: '20190102_104350_HDR.jpg', type: 'image' },
                    { src: '20190102_104423_HDR.jpg', type: 'image' },
                    { src: '20190102_104530_HDR.jpg', type: 'image' },
                    { src: '45b36dd9-314a-4806-ac07-a787081b9f22.jpg', type: 'image' },
                    { src: '69022eda-cd68-4908-b5a6-07c8763fbc2f.jpg', type: 'image' },
                    { src: '809f14db-b668-4ebe-859e-e7137b250aa6.jpg', type: 'image' },
                    { src: '97dec14e-f5ce-4367-a610-a8676794aa12.jpg', type: 'image' },
                    { src: '9d580304-14e2-467e-8400-b8e4c4a72cf0.jpg', type: 'image' },
                    { src: 'DIRECTORIO%20TVS.jpg', type: 'image' },
                    { src: 'DMC-FZ70600.JPG', type: 'image' },
                    { src: 'DMC-FZ70629.JPG', type: 'image' },
                    { src: 'DMC-FZ70721.JPG', type: 'image' },
                    { src: 'IMAG0097.jpg', type: 'image' },
                    { src: 'IMAG0099.jpg', type: 'image' },
                    { src: 'IMAG0214.jpg', type: 'image' },
                    { src: 'IMAG0217.jpg', type: 'image' },
                    { src: 'IMAG0753.jpg', type: 'image' },
                    { src: 'IMAG0754.jpg', type: 'image' },
                    { src: 'IMAG0804.jpg', type: 'image' },
                    { src: 'IMAG0805.jpg', type: 'image' },
                    { src: 'IMG_20150307_172321.jpg', type: 'image' },
                    { src: 'IMG_20150528_124532.jpg', type: 'image' },
                    { src: 'IMG-20170815-WA0009.jpg', type: 'image' },
                    { src: 'IMG_20190613_142949605.jpg', type: 'image' },
                    { src: 'IMG_20190613_143803714.jpg', type: 'image' },
                    { src: 'IMG_20190613_143832949.jpg', type: 'image' },
                    { src: 'IMG_20190614_101641553.jpg', type: 'image' },
                    { src: 'IMG_20190614_121421218.jpg', type: 'image' },
                    { src: 'IMG_20190614_123123081.jpg', type: 'image' },
                    { src: 'IMG_20190628_183807218.jpg', type: 'image' },
                    { src: 'IMG-20191026-WA0022.jpg', type: 'image' },
                    { src: 'IMG_20191028_195706005.jpg', type: 'image' },
                    { src: 'IMG_20191028_195900111.jpg', type: 'image' },
                    { src: 'IMG-20210316-WA0007.jpg', type: 'image' },
                    { src: 'IMG-20210330-WA0007.jpeg', type: 'image' },
                    { src: 'IMG20210727125634.jpg', type: 'image' },
                    { src: 'IMG20210730084545.jpg', type: 'image' },
                    { src: 'IMG20210929100724.jpg', type: 'image' },
                    { src: 'IMG20210929104959.jpg', type: 'image' },
                    { src: 'IMG20211025110805.jpg', type: 'image' },
                    { src: 'IMG20230130100902.jpg', type: 'image' },
                    { src: 'IMG20230130101141.jpg', type: 'image' },
                    { src: 'IMG20230130101222.jpg', type: 'image' },
                    { src: 'IMG20230130103508.jpg', type: 'image' },
                    { src: 'IMG_20230209_124439.jpg', type: 'image' },
                    { src: 'IMG_20230523_102556.jpg', type: 'image' },
                    { src: 'IMG20230718152344.jpg', type: 'image' },
                    { src: 'IMG20230815102639.jpg', type: 'image' },
                    { src: 'IMG20231018163702.jpg', type: 'image' },
                    { src: 'IMG20231018163756.jpg', type: 'image' },
                    { src: 'IMG20240129112152.jpg', type: 'image' },
                    { src: 'IMG-20240809-WA0029.jpg', type: 'image' },
                    { src: 'IMG_20240903_101848664_HDR_AE.jpg', type: 'image' },
                    { src: 'IMG_20240927_105653908_HDR_AE.jpg', type: 'image' },
                    { src: 'IMG_20240927_105707713_AE.jpg', type: 'image' },
                    { src: 'IMG_20241218_103805305_AE.jpg', type: 'image' },
                    { src: 'IMG-20241218-WA0003%20(2).jpg', type: 'image' },
                    { src: 'IMG_20250213_174821279_AE.jpg', type: 'image' },
                    { src: 'IMG_20250213_174825212_AE.jpg', type: 'image' },
                    { src: 'IMG_20250213_174836332_AE.jpg', type: 'image' },
                    { src: 'IMG_20250213_174844674_AE.jpg', type: 'image' },
                    { src: 'IMG_20250220_164943725_AE.jpg', type: 'image' },
                    { src: 'P1030049.JPG', type: 'image' },
                    { src: 'P1030053.JPG', type: 'image' },
                    { src: 'Panasonic3.jpg', type: 'image' },
                    { src: 'Samsung%20Large%20Digital%20Signage%20Video%20Wall%20Displa.mp4', type: 'video' },
                    { src: 'terraza%20comedor%201.jpg', type: 'image' },
                    { src: 'VID_20190613_144428643.mp4', type: 'video' },
                    { src: 'VID_20190613_144610668.mp4', type: 'video' },
                    { src: 'VID_20190614_104804790.mp4', type: 'video' }
                ]
            }
        };

        // --- INICIALIZACIÓN Y FUNCIONES PRINCIPALES ---
        document.addEventListener('DOMContentLoaded', () => {
            // Inicializar todas las funciones de la página
            initLoader();
            initBackgrounds();
            initNewsFeed();
            initThemeToggle();
            initMainLogoVideo();
            initGallery();
        });

        // --- SECCIÓN: PANTALLA DE CARGA (LOADER) ---
        function initLoader() {
            const loaderBar = document.getElementById('loader-bar');
            const loaderBg = document.getElementById('loader-bg');
            if (!loaderBar || !loaderBg) return;

            let progress = 0;
            const duration = 3000;
            const interval = 30;
            const step = 100 / (duration / interval);

            const intv = setInterval(() => {
                progress += step;
                if (progress > 100) progress = 100;
                loaderBar.style.width = progress + '%';
                if (progress >= 100) {
                    clearInterval(intv);
                    loaderBg.style.opacity = '0';
                    setTimeout(() => {
                        loaderBg.style.display = 'none';
                        document.body.style.overflowY = 'scroll';
                    }, 500);
                }
            }, interval);
        }

        // --- SECCIÓN: FONDOS Y ANIMACIONES VISUALES ---
        function initBackgrounds() {
            const allImageUrls = Object.values(galleries).flatMap(gallery => gallery.items.filter(item => item.type === 'image').map(item => GITHUB_BASE_URL + item.src));
            
            const random = (min, max) => Math.random() * (max - min) + min;

            // Elementos flotantes del loader
            const floatingLoaderImgs = allImageUrls.slice(0, 6);
            const area = document.getElementById('loader-floating');
            const width = window.innerWidth;
            const height = window.innerHeight;

            floatingLoaderImgs.forEach(src => {
                let img = document.createElement('img');
                img.src = src;
                img.className = 'floating-img';
                img.style.left = random(0, width - 120) + 'px';
                img.style.top = random(0, height - 80) + 'px';
                img.dataset.dx = random(1, 2) * (Math.random() > 0.5 ? 1 : -1);
                img.dataset.dy = random(0.7, 1.4) * (Math.random() > 0.5 ? 1 : -1);
                area.appendChild(img);
            });
            
            function animateFloating() {
                const elements = area.children;
                for (let el of elements) {
                    let x = parseFloat(el.style.left);
                    let y = parseFloat(el.style.top);
                    let dx = parseFloat(el.dataset.dx);
                    let dy = parseFloat(el.dataset.dy);
                    let w = el.offsetWidth;
                    let h = el.offsetHeight;
                    x += dx;
                    y += dy;
                    if (x < 0 || x > width - w) el.dataset.dx = -dx;
                    if (y < 0 || y > height - h) el.dataset.dy = -dy;
                    el.style.left = x + 'px';
                    el.style.top = y + 'px';
                }
                if (document.getElementById('loader-bg').style.display !== 'none') {
                    requestAnimationFrame(animateFloating);
                }
            }
            animateFloating();

            // Fondo dinámico principal
            const backgroundArea = document.getElementById('background-floating-images');
            for (let i = 0; i < 20; i++) {
                const img = document.createElement('img');
                img.src = allImageUrls[Math.floor(random(0, allImageUrls.length))];
                img.className = 'bg-floating-img';
                const size = random(200, 400);
                img.style.width = size + 'px';
                img.style.height = size + 'px';
                img.style.left = random(-size / 2, width - size / 2) + 'px';
                img.style.top = random(-size / 2, height - size / 2) + 'px';
                img.style.animationDelay = random(0, 10) + 's';
                img.style.animationDuration = random(12, 25) + 's';
                backgroundArea.appendChild(img);
            }
        }
        
        // --- SECCIÓN: GALERÍA Y LIGHTBOX ---
        let currentGalleryItems = [];
        let currentItemIndex = 0;

        function initGallery() {
            const galleryContainer = document.getElementById('gallery-container');
            const filterButtons = document.querySelectorAll('.filter-button');

            // Renderizar todas las galerías inicialmente
            renderGalleries(galleries);

            filterButtons.forEach(button => {
                button.addEventListener('click', () => {
                    filterButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    const filter = button.dataset.filter;
                    filterGalleries(filter);
                });
            });
        }

        function renderGalleries(galleriesToRender) {
            const galleryContainer = document.getElementById('gallery-container');
            galleryContainer.innerHTML = ''; // Limpiar contenedor
            
            for (const key in galleriesToRender) {
                const galleryData = galleriesToRender[key];
                const galleryWrapper = document.createElement('div');
                galleryWrapper.id = `gallery-${key}`;
                galleryWrapper.className = 'gallery';
                
                galleryWrapper.innerHTML = `
                    <h3 class="gallery-title">${galleryData.title}</h3>
                    <div class="gallery-grid"></div>
                `;

                const grid = galleryWrapper.querySelector('.gallery-grid');
                galleryData.items.forEach((item, index) => {
                    const fullSrc = GITHUB_BASE_URL + item.src;
                    const itemElement = document.createElement('div');
                    itemElement.className = 'gallery-item';
                    itemElement.dataset.type = item.type;
                    itemElement.dataset.src = fullSrc;
                    itemElement.dataset.gallery = key;
                    itemElement.dataset.index = index;

                    if (item.type === 'image') {
                        itemElement.innerHTML = `<img src="${fullSrc}" alt="${galleryData.title} - Item ${index + 1}">`;
                    } else if (item.type === 'video') {
                        itemElement.innerHTML = `
                            <video src="${fullSrc}#t=0.5" preload="metadata"></video>
                            <div class="video-overlay"><i class="fas fa-play"></i></div>
                        `;
                    }
                    
                    itemElement.addEventListener('click', () => openLightbox(itemElement));
                    grid.appendChild(itemElement);
                });
                galleryContainer.appendChild(galleryWrapper);
            }
        }
        
        function filterGalleries(filter) {
            if (filter === 'all') {
                renderGalleries(galleries);
            } else {
                const filtered = { [filter]: galleries[filter] };
                renderGalleries(filtered);
            }
        }

        function openLightbox(element) {
            const type = element.dataset.type;
            const src = element.dataset.src;
            const galleryKey = element.dataset.gallery;
            
            currentGalleryItems = galleries[galleryKey].items.filter(item => item.type === type);
            const currentItem = currentGalleryItems.find(item => GITHUB_BASE_URL + item.src === src);
            currentItemIndex = currentGalleryItems.indexOf(currentItem);

            if (type === 'image') {
                openImageLightbox(src);
            } else if (type === 'video') {
                openVideoLightbox(src);
            }
        }
        
        function openImageLightbox(src) {
            const lightbox = document.getElementById('image-lightbox');
            const lightboxImg = document.getElementById('lightbox-img');
            lightboxImg.src = src;
            lightbox.style.display = 'flex';
        }

        function closeImageLightbox() {
            document.getElementById('image-lightbox').style.display = 'none';
        }

        function openVideoLightbox(src) {
            const lightbox = document.getElementById('video-lightbox');
            const lightboxVideo = document.getElementById('lightbox-video');
            lightboxVideo.src = src;
            lightbox.style.display = 'flex';
            lightboxVideo.play();
        }

        function closeVideoLightbox() {
            const lightbox = document.getElementById('video-lightbox');
            const lightboxVideo = document.getElementById('lightbox-video');
            lightboxVideo.pause();
            lightboxVideo.src = '';
            lightbox.style.display = 'none';
        }

        function navigateLightbox(direction) {
            currentItemIndex = (currentItemIndex + direction + currentGalleryItems.length) % currentGalleryItems.length;
            const nextItem = currentGalleryItems[currentItemIndex];
            openImageLightbox(GITHUB_BASE_URL + nextItem.src);
        }

        // --- SECCIÓN: NOTICIAS, TEMA Y OTROS ---
        function initNewsFeed() {
            fetch('https://api.rss2json.com/v1/api.json?rss_url=https://www.ravepubs.com/feed/')
                .then(res => res.json())
                .then(data => {
                    const container = document.getElementById('rave-feed');
                    if (!data.items) return;
                    container.innerHTML = '';
                    data.items.slice(0, 5).forEach(item => {
                        const li = document.createElement('li');
                        li.innerHTML = `<a href="${item.link}" target="_blank">${item.title}</a><br><small>${new Date(item.pubDate).toLocaleDateString()}</small>`;
                        container.appendChild(li);
                    });
                })
                .catch(() => {
                    document.getElementById('rave-feed').innerHTML = '<li>No se pudo cargar el feed.</li>';
                });
        }

        function initThemeToggle() {
            const themeToggle = document.getElementById('theme-toggle');
            if (!themeToggle) return;
            const body = document.body;
            const themeIcon = themeToggle.querySelector('i');

            const applyTheme = () => {
                const savedTheme = localStorage.getItem('theme');
                const prefersDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
                setTheme(savedTheme === 'dark' || (!savedTheme && prefersDarkMode) ? 'dark' : 'light');
            };

            const setTheme = (theme) => {
                body.classList.toggle('dark-mode', theme === 'dark');
                themeIcon.className = theme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
                localStorage.setItem('theme', theme);
            };

            themeToggle.addEventListener('click', () => {
                const newTheme = body.classList.contains('dark-mode') ? 'light' : 'dark';
                setTheme(newTheme);
            });
            
            applyTheme();
        }

        function initMainLogoVideo() {
            const mainLogoVideo = document.getElementById('main-logo-video');
            if (mainLogoVideo) {
                mainLogoVideo.addEventListener('click', () => {
                    mainLogoVideo.currentTime = 0;
                    mainLogoVideo.play();
                });
            }
        }
        
        // Cerrar lightboxes con la tecla ESC
        document.addEventListener('keydown', (e) => {
            if (e.key !== 'Escape') return;
            if (document.getElementById('image-lightbox').style.display === 'flex') {
                closeImageLightbox();
            }
            if (document.getElementById('video-lightbox').style.display === 'flex') {
                closeVideoLightbox();
            }
        });
    </script>
</body>
</html>